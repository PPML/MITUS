################################################################################
##### THE CODE BELOW WILL GATHER AND FORMAT INPUTS FOR THE TB_MODEL        #####
##### FUNCTION FILE. ALL VARIABLE NAMES THAT END IN t ARE INDEXED BY TIME; #####
##### VARIABLE NAMES BEGINNING WITH m ARE MATRICES & V ARE VECTORS.        #####
################################################################################
##### THIS FILE USES FUNCTIONS FOUND IN BASIC_FUNCTIONS.R                  #####
################################################################################
library(MASS)
source("R/basic_functions.R")
#source("R/define_P.R")
load("data/ModelInputs_9-2-16.rData")

################################################################################
##### INTERVENTION
################################################################################
if(Int5==1) {
  Int1 = Int2 = Int3 = Int4 = 1
}

################################################################################
###########################          INPUTS            #########################
################################################################################
BgMort           <- Inputs[["BgMort"]]
InitPop          <- Inputs[["InitPop"]]
Births           <- Inputs[["Births"]]
ImmigInputs      <- Inputs[["ImmigInputs"]]
TxInputs         <- Inputs[["TxInputs"]]

##########                PARAMETER DEFINITIONS                      ###########
#######################           BIRTHS                 #######################
####### INDEXED BY TIME, ABSOLUTE NUMBER OF NEW ADULT ENTRANTS OVER TIME #######

Birthst   <- SmoCurve(Births)*P["TunBirths"]/12

##########################      MORTALITY RATES       ##########################
########################## BACKGROUND MORTALITY BY TIME ########################
mubt      <- matrix(NA,1801,11)
for(i in 1:11) {
  mubt[,i] <- SmoCurve(BgMort[,i+1])*P["TunMubt"]/12
}
RRmuHR    <- c(1,P["RRmuHR"],1,1)
#########################     DISEASE SPECIFIC       ###########################
#############    ACTIVE TB RATES DEFAULT TO THE SMEAR POS LEVELS   #############

muIp  	  <- P["muIp"]/12
############ CONVERT ANNUAL RATES OF RF MORTALITY TO MONTHLY RATES ##########

############ THESE MUST BE UPDATED
muRF      <- P["muH1"]/12
muTbRF    <- P["muTbH"]/12

###############  RATE RATIO OF MORTALITY INCREASE FOR HIGH RISK ###############

RRmuHR    <- c(1,P["RRmuHR"])

############### CREATE A MATRIX OF RF MORTALITIES BY AGE GROUP ###############

vRFMort    <- c(0,0,0,0);
names(vRFMort) <- c("RF1","RF2","RF3","RF4")
vRFMort[2] <- (1/3)*muRF
vRFMort[3] <- (2/3)*muRF
vRFMort[4] <- muRF
######################## MULTIPLER OF MORT RATE ABOVE ########################

TunmuTbAg <- P["TunmuTbAg"]

############### CREATE A MATRIX OF TB MORTALITIES BY AGE GROUP ###############

vTMort   <- matrix(0,11,6);
rownames(vTMort) <- c("0_4",paste(0:8*10+5,1:9*10+4,sep="_"),"95p")
colnames(vTMort) <- c("Su","Sp","Ls","Lf","Ac","Tx")
vTMort[,5] <- muIp #active disease rates default to smear positive
RRmuTbAg <- exp(c(0,0,1:9)*TunmuTbAg)
for(i in 1:ncol(vTMort)) {
  vTMort[,i] <- vTMort[,i] * RRmuTbAg
}


######################## MULTIPLER OF MORT RATE ABOVE ########################

TunmuTbAg <- P["TunmuTbAg"]

#################                IMMIGRATION              #####################
 TotImmig1       <- c(ImmigInputs[[1]][1:65],(ImmigInputs[[1]][66:151]-ImmigInputs[[1]][66])*P["ImmigVolFut"]+ImmigInputs[[1]][66])/12*P["ImmigVol"]
 TotImmig0       <- (c(ImmigInputs[[1]][1:151])+c(rep(0,65),cumsum(rep(P["ImmigVolFut"],86))))/12*P["ImmigVol"]
#set.seed( rand_seed)
# TotImmig1       <-   c(TotImmig0[1:66],exp(mvrnorm(1, log(TotImmig0[-(1:66)]), vcv_gp_l10_sd0.1))) # Add gaussian process noise
TotImmig1       <-   TotImmig0
TotImmig        <- SmoCurve(TotImmig1)
TotImmAge       <- outer(TotImmig,ImmigInputs[["AgeDist"]])
#######################   IMMIGRATION WITH LATENT TB   #######################

PrevTrend25_340l <- c(ImmigInputs[["PrevTrend25_34"]][1:65]^P["TunLtbiTrend"]*ImmigInputs[["PrevTrend25_34"]][65]^(1-P["TunLtbiTrend"]),
                      ImmigInputs[["PrevTrend25_34"]][66:151]*(P["ImmigPrevFutLat"]/0.99)^(1:86))

#set.seed(rand_seed+1)
# PrevTrend25_341l <-   c(PrevTrend25_340l[1:66],exp(mvrnorm(1, log(PrevTrend25_340l[-(1:66)]), vcv_gp_l10_sd0.1))) # Add gaussian process noise
PrevTrend25_341l <-   PrevTrend25_340l
PrevTrend25_34l  <- SmoCurve(PrevTrend25_341l)
PrevTrend25_34_ls <- (PrevTrend25_34l); PrevTrend25_34_ls <- PrevTrend25_34_ls/PrevTrend25_34_ls[(2011-1950)*12+6]
ImmLat          <- matrix(NA,length(PrevTrend25_34_ls),11)
for(i in 1:11) ImmLat[,i] <- (1-exp((-(c(2.5,1:9*10,100)/100)[i]*P["LtbiPar1"]-(c(2.5,1:9*10,100)/100)[i]^2*P["LtbiPar2"])*PrevTrend25_34_ls))*TotImmAge[,i]

#######################   IMMIGRATION WITH ACTIVE TB   #######################
PrevTrend25_340a <- c(ImmigInputs[["PrevTrend25_34"]][1:65],ImmigInputs[["PrevTrend25_34"]][66:151]*(P["ImmigPrevFutAct"]/0.99)^(1:86))
#set.seed( rand_seed+2)
# PrevTrend25_341a <-   c(PrevTrend25_340a[1:66],exp(mvrnorm(1, log(PrevTrend25_340a[-(1:66)]), vcv_gp_l10_sd0.1))) # Add gaussian process noise
PrevTrend25_341a <-   PrevTrend25_340a
PrevTrend25_34a  <- SmoCurve(PrevTrend25_341a)
ImDxChngV      <- SmoCurve(c(rep(1,57),seq(1,P["ImDxChng"],length.out=6)[-1],rep(P["ImDxChng"],89)))
ImmAct         <- outer(PrevTrend25_34a*P["RRtbprev"]*ImDxChngV,ImmigInputs[["RR_Active_TB_Age"]])*TotImmAge*P["pImAct"]
ImmFst         <- outer(PrevTrend25_34a*P["RRtbprev"],ImmigInputs[["RR_Active_TB_Age"]])*TotImmAge*(1-P["pImAct"])
ImmNon         <- TotImmAge-ImmAct-ImmFst-ImmLat

#### #### #### INT 1 #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####
pctDoc <- (1-0.28)
if(Int1==1) {
  for(i in 1:11) ImmLat[,i] <- ImmLat[,i]*(1-LgtCurve(2016,2021,1)*P["SensLt"]*P["EffLt"]*(1-P["pDefLt"])*pctDoc)
  for(i in 1:11) ImmAct[,i] <- ImmAct[,i]*(1-LgtCurve(2016,2021,1)*P["SensLt"]*P["EffLt"]*(1-P["pDefLt"])*pctDoc)
  for(i in 1:11) ImmFst[,i] <- ImmFst[,i]*(1-LgtCurve(2016,2021,1)*P["SensLt"]*P["EffLt"]*(1-P["pDefLt"])*pctDoc)
  ImmNon         <- TotImmAge-ImmAct-ImmFst-ImmLat   }


#### #### #### SCEN 2 #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

if(Scen2==1) {
  for(i in 1:11) ImmLat[,i] <- ImmLat[,i]*(1-LgtCurve(2016,2017,1))
  for(i in 1:11) ImmAct[,i] <- ImmAct[,i]*(1-LgtCurve(2016,2017,1))
  for(i in 1:11) ImmFst[,i] <- ImmFst[,i]*(1-LgtCurve(2016,2017,1))
  ImmNon         <- TotImmAge-ImmAct-ImmFst-ImmLat   }


#### #### #### SCEN 3 #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

if(Scen3==1) {
  adjf <- (1-0.5)^(1/10/12);  adjfV <- adjf^(0:1008)
  for(i in 1:11) ImmLat[793:1801,i] <- ImmLat[793:1801,i]*adjfV
  for(i in 1:11) ImmAct[793:1801,i] <- ImmAct[793:1801,i]*adjfV
  for(i in 1:11) ImmFst[793:1801,i] <- ImmFst[793:1801,i]*adjfV
  ImmNon         <- TotImmAge-ImmAct-ImmFst-ImmLat   }

#######################__EXOGENEOUS INFECTION RISK    #######################

# NEED TO REMOVE DRUG RESISTANCE
ExogInf        <- rep(NA,length(PrevTrend25_34a))
ExogInf        <- P["ExogInf"]*PrevTrend25_34a/PrevTrend25_341a["2013"]/12
#removed *(ImmigInputs[[7]][4]*DrN[,i]+(1-ImmigInputs[[7]][4])*DrE[,i])
###############################    EMMIGRATION   ##############################

rEmmigFB <- c(P["rEmmigF1"],P["rEmmigF2"])/12


##########################  HIGH-RISK ENTRY/EXIT  #############################

p_HR     <- P["pHR"]
yr       <- c(2.5,1:10*10)
r0_5     <- 1/3;
r45_55 <- 1/20
HR_exit  <- r0_5*((r45_55/r0_5)^(1/(50-2.5)))^(yr-2.5)
HR_entry <- HR_exit*p_HR*1.3
HrEntEx  <- cbind(HR_entry,HR_exit)/12

##########################   TB TRANSMISSION  #################################

CR           <- P["CR"]/12
TrIn         <- P["TrIn"]	# Contact rate for In as a fraction of Ip
RelInfRg     <- c(1.0,P["RelCrHr"],1.0, 1.0)*CR
TunTbTransTx <- P["TunTbTransTx"]  # set to zero?
Vmix         <- 1-c(P["sigmaHr"],P["sigmaFb"])
RelInf       <- rep(0,6)
names(RelInf) <- c("Su","Sp","Ls","Lf","Ac", "Tx")
RelInf[5] <- 1;
RelInf[6] <- RelInf[5]*TunTbTransTx

#########################   TB NATURAL HISTORY  ###############################
#########################__   EARLY EPIDEMTIC   ###############################

Early0 <- P["Early0"]
EarlyTrend <- c(rep(1+Early0,200*12),seq(1+Early0,1.0,length.out=50*12+2))

######################     PROGRESSION TO DISEASE     ##########################

pfast      <- P["pfast"]
ORpfast1   <- P["ORpfast1"] ## age group 1
ORpfast2   <- P["ORpfast2"] ## age group 2
ORpfastRF  <- P["ORpfastH"] ##riskfactor
ORpfastPI  <- P["ORpfastPI"]
rslow      <- P["rslow"]/12
rslowRF    <- P["rslowH"]/12
RRrslowRF  <- rslowRF/rslow
rfast      <- P["rfast"]/12
rrSlowFB0  <- P["rrSlowFB"]
rrSlowFB   <- c(1,rrSlowFB0,rrSlowFB0)
##############            ORIGINAL Mpfast[ag][hv]             ################
##############          CREATE NEW Mpfast[ag][im]               ##############
############## MIGHT WRITE A NEW SCRIPT FOR THIS PART
Mpfast       <- matrix(NA,11,4)
############## CREATE AN ODDS FROM THE PROB OF FAST PROGRESSION ##############
Mpfast[,]    <- pfast/(1-pfast)
Mpfast[1,]   <- Mpfast[1,]*ORpfast1 # progression for age group 1
Mpfast[2,]   <- Mpfast[2,]*ORpfast2 # progression for age group 2
############ UPDATE PROBS FOR LEVEL 2 OF REACTIVATION ###########
Mpfast[,2]   <- (ORpfastRF*1/3)*Mpfast[,2]
############ UPDATE PROBS FOR LEVEL 3 OF REACTIVATION ###########
Mpfast[,3]   <- (ORpfastRF*2/3)*Mpfast[,3]
############ UPDATE PROBS FOR LEVEL 4 OF REACTIVATION ###########
Mpfast[,4]   <- Mpfast[,4]*ORpfastRF #progression for tb reactivation group 4

#################       CREATE A NEW MATRIX PARTIAL. IMM.     #################
MpfastPI     <- Mpfast
MpfastPI[,1] <- Mpfast[,1]*ORpfastPI
MpfastPI[,2] <- (ORpfastRF*1/3)*MpfastPI[,1]
MpfastPI[,3] <- (ORpfastRF*2/3)*MpfastPI[,1]

### ADD IN THE INV LOGIT FOR THE OTHER FACTOR LEVELS

##### UPDATE BOTH MATRICES WITH PROBABILITIES, NOT RATES
Mpfast[,]    <- Mpfast[,]  /(1+Mpfast[,]);
MpfastPI[,]  <- MpfastPI[,]/(1+MpfastPI[,]);

############# CREATE A VECTOR FOR RATE OF SLOW PROGRESSION THAT WILL
############# VARY BASED ON LEVELS OF TB REACTIVATION RATES
Vrslow     <- rep(rslow,4)
############# UPDATE LEVEL FOUR OF THE RATE OF SLOW BASED ON CALCULATED RR FROM
############# USER INPUTTED RR FOR THE RISK FACTOR
for (i in 2:4){
  Vrslow[i]=Vrslow[i]*RRrslowRF*((i-1)/3)
}

TunrslowAge  <- P["TunrslowAge"]
rrReactAg       <- exp(c(0,0,0,0,0,0,0.5,1:4)*P["TunrslowAge"])
Mrslow <- outer(rrReactAg,Vrslow)


#######################       RATE OF RECOVERY          ########################

rRecov     <-  P["rRecov"]/12

#######################       RATE OF SELF CURE         ########################

rSlfCur      <- P["rSlfCur"]/12

##################### __         LTBI DIAGNOSIS           #######################
rLtScrt       <- LgtCurve(1985,2015,P["rLtScr"])/12
SensLt        <- P["SensLt"]    #  sens of test for latent TB infection (based on IGRA QFT-GIT)
###removed sens for HIV
SpecLt        <- P["SpecLt"]    #  spec of test for latent TB infection (based on IGRA QFT-GIT)
SpecLtFb      <- SpecLt         #  spec of test for latent TB infection (based on IGRA QFT-GIT) in foreign-born (assumed BCG exposed)
###removed rrTestHIV
rrTestHr      <- P["rrTestHr"] # RR of LTBI screening for HIV and HR as cmpared to general
rrTestLrNoTb  <- P["rrTestLrNoTb"] # RR of LTBI screening for individuals with no risk factors
dLt           <- 1/9
rDefLt        <- dLt*P["pDefLt"]/(1-P["pDefLt"])  # based on 50% tx completion with 6 mo INH regimen 2.0 [1.0,3.0] from Menzies Ind J Med Res 2011
EffLt         <- P["EffLt"]
LtTxPar       <- c(dLt,rDefLt,EffLt)

dLtt          <- (1-LgtCurve(2016,2021,0)) * 1/9

EffLt0        <- LgtCurve(2016,2021,0)+1
EffLtX        <- cbind(EffLt0,0,EffLt0,0,0)

#### #### #### INT 2 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

if(Int2==1) { rLtScrt    <- rLtScrt + LgtCurve(2016,2021,1)*rLtScrt*1
EffLtX[,2] <- LgtCurve(2016,2021,1)
dLtt       <- (1-LgtCurve(2016,2021,1))*(1/9) + LgtCurve(2016,2021,1)*(1/3)  }

#### #### #### INT 2 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

LtDxPar <- matrix(NA,3,2);
colnames(LtDxPar) <- c("latent","no latent");
rownames(LtDxPar) <- c("LR","HR","FB")
LtDxPar[,1] <- c(SensLt                 , rrTestHr*SensLt    , SensLt)
LtDxPar[,2] <- c(rrTestLrNoTb*(1-SpecLt), rrTestHr*(1-SpecLt), (1-SpecLtFb))

pImmScen    <- P["pImmScen"] # lack of reactivitiy to IGRA for Sp

################################################################################
#######################         TB DIAGNOSIS            ########################
#######################      TEST CHARACTERISTICS       ########################

SensSp    <- P["SensSp"]

######################           PROVIDER DELAY         ########################

DelaySp    <- P["DelaySp"]

#######################     PROVIDER DELAY RR ELDERLY     ########################

TunRRdxAge    <- P["TunRRdxAge"]
RRdxAge       <- 1+(c(rep(1,6),cumprod(seq(1.05,1.3,length.out=5)))-1)*TunRRdxAge

#######################         ATTENDANCE RATE           ########################

n_Spln   <- 5; n_Stps   <- 2010-1950+1; dif_pen   <- 1 # quadratic spline
# Working...
x1    <- seq(1,n_Stps);  k1  <- seq(min(x1),max(x1),length=n_Spln-dif_pen)
dk1   <- k1[2]-k1[1] ;   k1  <- c(k1[1]-dk1*((dif_pen+1):1),k1,k1[n_Spln-dif_pen]+dk1*(1:(dif_pen+1)))
SpMat <- matrix(NA,nrow=n_Stps,ncol=n_Spln); for(i in 1:n_Spln){ SpMat[,i] <- bspline(x=x1,k=k1,m=dif_pen,i=i)  }

DxPri          <- (seq(0.5,4,length.out=5)-0.75)*3.5/2.626+0.25  # Prior from 0.5 t to 4.0
rDx            <- c(SpMat%*%(DxPri+c(P["Dx1"],P["Dx2"],P["Dx3"],P["Dx4"],P["Dx5"])),62:151)
rDx[62:151]    <- rDx[61] + (rDx[61]-rDx[60])*cumsum((0.75^(1:90)))
rDxt0          <- SmoCurve(rDx)/12;
rDxt1          <- cbind(rDxt0,rDxt0)

rDxt           <- 1/(1/rDxt1+DelaySp)*SensSp
rDxt[,2]       <- (rDxt[,1]-min(rDxt[,1]))/P["rrDxH"]+min(rDxt[,1]) #check this with Nick
colnames(rDxt) <- c("Active","Active_HighRisk")
#### #### #### INT 3 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

if(Int3==1) { for(i in 1:4) { rDxt[,i] <- rDxt[,i]+ rDxt[,i]*LgtCurve(2016,2021,1)     }   }

#### #### #### INT 3 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

## DST
pDstt       <- LgtCurve(1985,2000,P["pDst"])

#### #### #### INT 4 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

if(Int4==1) {  pDstt <- 1-(1-pDstt)*(1-LgtCurve(2016,2021,0.5))      }

#### #### #### INT 4 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

######  TREATMENT OUTCOMES  ######
TunTxMort	<- P["TunTxMort"]	# Multiplier to adjust mortality rates while on treatment into reasonable range (based on observed data) 0 = no TB mort on TX

# Regimen duration (no uncertainty?)
d1st <- 1/9

## Regimen efficacy
pCurPs  <- P["pCurPs"]    # probability of cure with pansensitive TB, 1st line regimen (Menzies 09)
TxE1		<- P["TxEf1"]     # RR cure given mono-resistance, 1st line regimen 0.90
TxE2		<- P["TxEf2"]     # RR cure given multiresistance, 1st line or 2nd line 0.50
TxE3		<- P["TxEf3"]     # RR cure given effective 2nd line 0.90

## Default
rDef0         <- rep(NA,151)
rDef0[1:30]   <- P["TxDefEarly"]
rDef0[44:63]  <- ORAdd(TxInputs[[1]][,2],P["TunTxDef"])
rDef0[64:151] <- rDef0[63]
rDef1         <- predict(smooth.spline(x=c(1950:1979,1993:2100),y=rDef0[-(31:43)],spar=0.4),x=1950:2100)$y
rDeft         <- SmoCurve(rDef1)/12;
rDeftH        <- rDeft*P["RRdefHR"] # second col is HR default rate

#### #### #### INT 4 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

if(Int4==1) {  rDeftH <- rDeftH*(1-LgtCurve(2016,2021,0.5))      }
if(Int4==1) {  rDeft  <- rDeft* (1-LgtCurve(2016,2021,0.5))      }

#### #### #### INT 4 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

## Tx quality
TxQual0         <- rep(NA,151)
TxQual0[1:30]   <- P["TxQualEarly"]
TxQual0[44:62]  <- ORAdd(TxInputs[[2]][,2],P["TunTxQual"])
TxQual0[63:151] <- TxQual0[62]
TxQual1         <- predict(smooth.spline(x=c(1950:1979,1993:2100),y=TxQual0[-(31:43)],spar=0.4),x=1950:2100)$y
TxQualt         <- SmoCurve(TxQual1);
RRcurDef        <- P["RRcurDef"]

#### #### #### INT 4 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

if(Int4==1) {  TxQualt <- 1-(1-TxQualt)*(1-LgtCurve(2016,2021,0.5))      }

#### #### #### INT 4 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

#### #### #### SCEN 1 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

NixTrans <- 1-LgtCurve(2016,2017,1)
if(Scen1==0) {  NixTrans[] <- 1      }

#### #### #### SCEN 1 #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####

## Retreatment
pReTx   <- LgtCurve(1985,2000,P["pReTx"])   	# Probability Tx failure identified, patient initiated on tx experienced reg (may be same)

### REMOVED ACQUIRED RESISTANCE PARAMETERS
### REPLACED TX MAT WITH VECTOR FOR SINGLE VALUES
#####################   NEW TB TREATMENT TABLE ################
TxVec           <- rep(NA,2)
names(TxVec) <- c("TxCompRate","TxEff")
TxVec[1]       <-  d1st
TxVec[2]       <- pCurPs
### REMOVED ART PARAMETERS
################################################################################
##### CREATE A LIST TO HOLD THE VECTORS FOR AGE CATEGORIES, TB STATES,     #####
##### DRUG RESISTANCE, TREATMENT HISTORY, HIV STATUS, AND RISK CATEGORY.   #####
################################################################################
################################################################################

################################################################################
StatList <- noquote(list(
  #####					                  AGE CATEGORIES                             #####
  #####           AGE GROUPS 0-4, 5-14, 15-24, ... , 95-94, 95+              #####
  c("0_4",paste(0:8*10+5,1:9*10+4,sep="_"),"95p"),
  #####					     				    TUBERCULOSIS STATES		              			   #####
  ##### SUSCEPTIBLE; UNINFECTED & PARTIALLY IMMUNE; LATENT SLOW; LATENT FAST;#####
  #####       ACTIVE TB SMEAR NEG.; ACTIVE TB SMEAR POS.; TB TREATMENT       #####
  c("Su","Sp","Ls","Lf", "Ac", "Tx"),
  #####                          TREATMENT HISTORY                           #####
  #####              NO TB TREATMENT HISTORY, PRIOR LTBI TREATMENT           #####
  c("NT","LT"),
  #####                        TB REACTIVATION RISK                          #####
  c("I1","I2","I3","I4"),
  #####                          NON-TB MORTALITY                            #####
  c("M1","M2","M3","M4"),
  #####                  LIVING CONDITIONS/RISK OF INFECTION                 #####
  c("LR","HR"),
  #####                              NATIVITY                                #####
  c("US","F1","F2")))
################################################################################
################################################################################
ResNam <- c("Year",                                         # year
            ##############################    POPULATION    ################################
            "N_ALL",                                        # total pop
            paste("N",StatList[[1]],sep="_"),               # pop by ag cat
            paste("N",StatList[[2]],sep="_"),               # pop by tb cat
            paste("N",StatList[[4]],sep="_"),               # pop by im cat
            paste("N",StatList[[5]],sep="_"),               # pop by nm cat
            paste("N",StatList[[6]],sep="_"),               # pop by rg cat
            paste("N",StatList[[7]],sep="_"),               # pop by na cat
            ###################    POPULATION W/ NATIVITY  ################################
            paste("N_US",StatList[[1]],sep="_"),            # US pop by ag cat
            paste("N_FB",StatList[[1]],sep="_"),            # FB pop by ag cat
            paste("N_US_LTBI",StatList[[1]],sep="_"),       # US LTBI pop by ag cat
            paste("N_FB_LTBI",StatList[[1]],sep="_"),       # FB LTBI pop by ag cat
            paste("N_RF",StatList[[1]],sep="_"),            # RF pop by ag cat
            #############################    MORTALITY    ################################
            paste("TBMORT_RFNEG",StatList[[1]],sep="_"),   # TB mort, HIV neg, by ag cat
            paste("TBMORT_RFPOS",StatList[[1]],sep="_"),   # TB mort, HIV pos, by ag cat
            paste("RFMORT",StatList[[1]],sep="_"),         # RF mort, by ag cat
            paste("TOTMORT",StatList[[1]],sep="_"),         # total mort, by ag cat
            #### @object 131
            #############################   TX OUTCOMES   ################################

            "TBTX_COMPLT","TBTX_DISCONT","TBTX_DIED",       # TB treatment outcomes complete, discontinue, death
            "NOTIF_ALL",                                    # total notif
            paste("NOTIF",StatList[[1]],sep="_"),           # notif by ag cat
            paste("NOTIF",StatList[[7]],sep="_"),         # notif by nat cat
            #            paste("NOTIF_HIV",c("POS","NEG"),sep="_"),      # notif by HIV pos/neg
            paste("NOTIF",StatList[[6]],sep="_"),           # notif by rg cat
            #           paste("NOTIF_US_N",StatList[[3]],sep="_"),      # notif, US, N, by dr cat
            #            paste("NOTIF_US_E",StatList[[3]],sep="_"),      # notif, US, E, by dr cat
            #           paste("NOTIF_FB_N",StatList[[3]],sep="_"),      # notif, FB, N, by dr cat
            #           paste("NOTIF_FB_E",StatList[[3]],sep="_"),      # notif, FB, E, by dr cat
            ###########################   TLTBI INITIATION   ##############################
            "TLTBI_INITS",                                  # Initiations on LTBI tx
            "TLTBI_INITS_FB",                               # Initiations on LTBI tx FB
            "TLTBI_INITS_HR",                               # Initiations on LTBI tx HR
            #            "TLTBI_INITS_HV",                               # Initiations on LTBI tx HV
            "TLTBI_INITS_TP",                               # Initiations on LTBI tx, with LTBI
            ###########################     TB INCIDENCE     ##############################
            "INCID_ALL",                                    # Total incidence
            paste("INCID_ALL",StatList[[1]],sep="_"),       # Total incidence by ag cat
            "INCID_ALL_US",                                 # Total incidence, US born
            "INCID_ALL_FB",                                 # Total incidence, foreign born
            "INCID_ALL_FB2",                                # Total incidence, foreign born
            "INCID_ALL_HR",                                 # Total incidence, high risk
            #            "INCID_ALL_HV",                                 # Total incidence, HIV pos
            "INCID_REC",                                    # Total incidence, recent infection
            paste("INCID_REC",StatList[[1]],sep="_"),       # Total incidence by ag cat, recent infection
            "INCID_REC_US",                                 # Total incidence, US born, recent infection
            "INCID_REC_FB",                                 # Total incidence, foreign born, recent infection
            "INCID_REC_FB2",                                # Total incidence, foreign born, recent infection
            "INCID_REC_HR",                                 # Total incidence, high risk, recent infection
            #            "INCID_REC_HV",                                 # Total incidence, HIV pos, recent infection
            ###########################    NOTIFICATION DEAD      ##############################
            "NOTIF_MORT_ALL",                               # total notif, dead at diagnosis
            paste("NOTIF_MORT",StatList[[1]],sep="_"),      # notif by ag cat, dead at diagnosis
            paste("NOTIF_MORT",StatList[[7]],sep="_"),      # notif by nat cat, dead at diagnosis
            #            paste("NOTIF_MORT_HIV",c("POS","NEG"),sep="_"), # notif by HIV pos/neg, dead at diagnosis
            paste("NOTIF_MORT",StatList[[6]],sep="_"),      # notif by rg cat, dead at diagnosis
            paste("NOTIF_US",StatList[[1]],sep="_"),        # notif by ag cat, US only
            paste("NOTIF_US_MORT",StatList[[1]],sep="_"),   # notif by ag cat, dead at diagnosis US only
            #            paste("NOTIF_MORT_HIV_Neg",StatList[[1]],sep="_"),    # notif by ag cat, dead at diagnosis HIV neg
            #            paste("TOTMORT_W_HIV",StatList[[1]],sep="_"),   # total mort, by ag cat, have HIV
            paste("TOTMORT_W_TB",StatList[[1]],sep="_"),     # total mort, by ag cat, have active TB
            c("N_Ls_US","N_Lf_US","N_Act_US"),
            c("N_Ls_FB","N_Lf_FB","N_Act_FB"),
            c("FOI_LR_US","FOI_HR_US","FOI_LR_FB","FOI_HR_FB" ), #force of infection
            c("TB_INF_LR","TB_INF_HR","TB_INF_US","TB_INF_F1","TB_INF_F2"), # NEW TB INFECTIONS
            c("TBMORT_US","TBMORT_NUS")           # tbmortality by nativity

)
length(ResNam)


###################################################


